<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#" lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="x-ua-compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hack Note (old posts, page 20) | Hack Note</title>
<meta name="description" content="Personal handnote on software development">
<meta name="theme-color" content="#04519b">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml">
<link href="/assets/css/minima.min.css" rel="stylesheet" type="text/css">
<link rel="canonical" href="https://blog.wangzhl.com/index-20.html">
<link rel="icon" href="/favicon.ico" sizes="64x64">
<link rel="prev" href="/index-19.html" type="text/html">
<link rel="next" href="/index-21.html" type="text/html">
</head>
<body>
  <header class="site-header nav-custom"><div class="wrapper">
      <a class="site-title" rel="author" href="/">Hack Note</a>
      <nav class="site-nav"><input type="checkbox" id="nav-trigger" class="nav-trigger"><label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px"><use href="/assets/svg/theme.svg#menu-icon"></use></svg></span>
        </label>
        <div class="trigger">
          
            <a class="page-link" href="/">Home</a>
            <a class="page-link" href="/archive/">Archive</a>
            <a class="page-link" href="/tags/">Tags</a>
            <a class="page-link" href="/about/">About</a>

        </div>
      </nav>
</div>
  </header><main class="page-content" aria-label="Content"><div class="wrapper">

    

    


  



  


<div class="home">
  <ul class="post-list">
<li>
    <span class="post-meta">Apr 11, 2018</span>
    <h3>
      <a class="post-link" href="/posts/fifo-pipe-unix-domain-socket/">Linux下的FIFO、pipe、unix domain socket漫谈</a>
    </h3>

    <p>
在做Linux开发时，经常会接触 <code>管道</code> 、 <code>AF_UNIX</code> 等相关词汇，为了弄清他们之间的关系，查阅了一些资料，将结果整理并记录下来。<br></p>



  </li>


  <li>
    <span class="post-meta">Apr 03, 2018</span>
    <h3>
      <a class="post-link" href="/posts/debug-with-gdb-on-linux-2/">Linux下使用gdb的调试技巧（2）</a>
    </h3>

    <p>
本文重点介绍在gdb模式下的常用命令。<br></p>



  </li>


  <li>
    <span class="post-meta">Apr 03, 2018</span>
    <h3>
      <a class="post-link" href="/posts/change-linux-timezone-with-cli/">使用命令行修改Linux系统的时区</a>
    </h3>

    <p>
<b>系统时区目录</b> 系统支持时区的配置文件存放在 <code>/usr/share/zoneinfo/</code> 目录下，可以进入到该目录下查看和搜索目标时区的相关配置文件。<br></p>

<p>
<b>时区配置文件</b> Linux系统的当前时区配置文件存放在 <code>/etc/localtime</code> , 可以将时区配置文件拷贝到该位置下，也可以建立一个软连接指向系统时区目录中的配置文件。<br></p>

<p>
<b>操作示例</b> 以将系统的时区改为中国时间为例，以下操作先将旧的时区配置文件删掉，然后建立新的时区配置文件的符号链接。<br></p>
<div class="highlight"><pre><span></span>rm /etc/localtime
ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
</pre></div>
<p>
完成以上操作后，可以执行 <code>date</code> 命令查看修改效果。<br></p>

  </li>


  <li>
    <span class="post-meta">Mar 28, 2018</span>
    <h3>
      <a class="post-link" href="/posts/linux-command-examples-netstat/">Linux常用命令行指令 - netstat</a>
    </h3>

    <p>
常见的选项有：<br>
-a (all)显示所有选项，netstat默认不显示LISTEN相关<br>
-t (tcp)仅显示tcp相关选项<br>
-u (udp)仅显示udp相关选项<br>
-n 拒绝显示别名，能显示数字的全部转化成数字。(重要)<br>
-l 仅列出有在 Listen (监听) 的服务状态<br>
-p 显示建立相关链接的程序名(macOS中表示协议 -p protocol)<br>
-r 显示路由信息，路由表<br>
-e 显示扩展信息，例如uid等<br>
-s 按各个协议进行统计 (重要)<br>
-c 每隔一个固定时间，执行该netstat命令。<br></p>

  </li>


  <li>
    <span class="post-meta">Mar 25, 2018</span>
    <h3>
      <a class="post-link" href="/posts/linux-command-examples-tcpdump/">Linux常用命令行指令 - tcpdump</a>
    </h3>

    <p>
tcpdump常用于网络抓包，能够将抓取的包保存下来，这样就能进一步深入分析。抓包保存的文件可以使用tcpdump进行查看，也可以借助第三方软件（如wireshark）进行辅助分析。<br></p>

<div id="outline-container-org8f4b168" class="outline-2">
<h2 id="org8f4b168">1. 抓取指定网络设备上的包</h2>
<div class="outline-text-2" id="text-org8f4b168">
<p>
抓取网卡eth0上的包<br></p>
<div class="highlight"><pre><span></span>tcpdump -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org2716a9f" class="outline-2">
<h2 id="org2716a9f">2. 限制抓包的数量</h2>
<div class="outline-text-2" id="text-org2716a9f">
<p>
只抓取5个包<br></p>
<div class="highlight"><pre><span></span>tcpdump -c 5 -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org273f530" class="outline-2">
<h2 id="org273f530">3. 将抓取的包以ASCII的方式打印出来</h2>
<div class="outline-text-2" id="text-org273f530">
<div class="highlight"><pre><span></span>tcpdump -A -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org8c7571b" class="outline-2">
<h2 id="org8c7571b">4. 将抓取的包以十六进制的方式打印出来</h2>
<div class="outline-text-2" id="text-org8c7571b">
<div class="highlight"><pre><span></span>tcpdump -XX -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-orgf91f766" class="outline-2">
<h2 id="orgf91f766">5. 对抓取到的包上打出更方便阅读的时间戳</h2>
<div class="outline-text-2" id="text-orgf91f766">
<p>
增加 <code>-t</code> 参数能够将抓取到的包中的时间以方便阅读的形式打印出来，使用 <code>-tttt</code> 参数能够将包中的时间戳以更详细的方式打印出来。<br></p>
<div class="highlight"><pre><span></span>tcpdump -t -i eth0
tcpdump -tttt -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-orgd2e480f" class="outline-2">
<h2 id="orgd2e480f">6. 将抓取的包写入到文件中</h2>
<div class="outline-text-2" id="text-orgd2e480f">
<div class="highlight"><pre><span></span>tcpdump -w netdump.pcap -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org8e41c8b" class="outline-2">
<h2 id="org8e41c8b">7. 读取抓到的包</h2>
<div class="outline-text-2" id="text-org8e41c8b">
<div class="highlight"><pre><span></span>tcpdump -r netdump.pcap
</pre></div>
</div>
</div>
<div id="outline-container-org0adc523" class="outline-2">
<h2 id="org0adc523">8. 在抓到的包中显示ip地址</h2>
<div class="outline-text-2" id="text-org0adc523">
<p>
增加 <code>-n</code> 参数不会解析主机名，增加 <code>-nn</code> 参数不会解析主机名和端口名<br></p>
<div class="highlight"><pre><span></span>tcpdump -n -i eth0
tcpdump -nn -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org09481fe" class="outline-2">
<h2 id="org09481fe">9. 以绝对值显示包的ISN号</h2>
<div class="outline-text-2" id="text-org09481fe">
<div class="highlight"><pre><span></span>tcpdump -S -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-orge9c8569" class="outline-2">
<h2 id="orge9c8569">10. 对抓取到的包显示更详细的信息</h2>
<div class="outline-text-2" id="text-orge9c8569">
<p>
参数 <code>-v</code> 是verbose的缩写，以下命令表示对抓取到的包显示更详细的信息。<br></p>
<div class="highlight"><pre><span></span>tcpdump -v -i eth0
tcpdump -vv -i eth0
tcpdump -vvv -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org2cd2674" class="outline-2">
<h2 id="org2cd2674">11. 对抓到的包进行协议类型过滤</h2>
<div class="outline-text-2" id="text-org2cd2674">
<p>
支持的协议类型有：fddi, tr, wlan, ip, ip6, arp, rarp, decnet, tcp, udp<br>
以下命令只会抓取网卡eth0上的arp包<br></p>
<div class="highlight"><pre><span></span>tcpdump -i eth0 arp
</pre></div>
</div>
</div>
<div id="outline-container-orgef16e74" class="outline-2">
<h2 id="orgef16e74">12. 在抓包时对包进行大小过滤</h2>
<div class="outline-text-2" id="text-orgef16e74">
<p>
下面的命令会分别抓取大于1024字节和小于1024字节的包<br></p>
<div class="highlight"><pre><span></span>tcpdump -i eth0 greater 1024
tcpdump -i eth0 less 1024
</pre></div>
</div>
</div>
<div id="outline-container-org6efab65" class="outline-2">
<h2 id="org6efab65">13. 抓取指定端口上的包</h2>
<div class="outline-text-2" id="text-org6efab65">
<div class="highlight"><pre><span></span>tcpdump -i eth0 port 22
</pre></div>
</div>
</div>
<div id="outline-container-org2f73fe3" class="outline-2">
<h2 id="org2f73fe3">14. 抓取发往指定目的和端口上包</h2>
<div class="outline-text-2" id="text-org2f73fe3">
<p>
可以使用 <code>and</code> 和 <code>or</code> 对过滤条件进行组合以实现精确的抓包。<br></p>
<div class="highlight"><pre><span></span>tcpdump -w net_dump.pcap -i eth0 dst 10.181.140.216 and port 22
</pre></div>
</div>
</div>

<div id="outline-container-org7c4ddbd" class="outline-2">
<h2 id="org7c4ddbd">常用tcpdump命令示例</h2>
<div class="outline-text-2" id="text-org7c4ddbd">
<div class="highlight"><pre><span></span>tcpdump –i any 'port 8888'
tcpdump –i any 'tcp port 8888'
tcpdump –i any 'tcp src port 8888'
tcpdump –i any 'tcp src port 8888 and udp dst port 9999'
tcpdump -i any 'src host 127.0.0.1 and tcp src port 12345' -XX -nn -vv
</pre></div>
</div>
</div>

<div id="outline-container-org63de4e8" class="outline-2">
<h2 id="org63de4e8">参考资料</h2>
<div class="outline-text-2" id="text-org63de4e8">
<ul class="org-ul">
<li>
<a href="https://danielmiessler.com/study/tcpdump/">danielmiessler.com tcpdump</a><br>
</li>
<li>
<a href="https://www.thegeekstuff.com/2010/08/tcpdump-command-examples/">thegeekstuff.com tcpdump</a><br>
</li>
</ul>
</div>
</div>

  </li>


  <li>
    <span class="post-meta">Mar 24, 2018</span>
    <h3>
      <a class="post-link" href="/posts/linux-command-examples-nc/">Linux常用命令行指令 - nc</a>
    </h3>

    <p>
<code>nc</code> 命令是 <code>netcat</code> 的缩写，能够使用TCP或UDP协议读写网络连接中的数据，是一个方便可靠的调试工具。<br></p>



  </li>

</ul>
</div>




    

  <ul class="index-pager hidden-print">
<li class="previous">
      <a href="/index-19.html" rel="prev">&lt; Newer posts</a>
    </li>
    <li class="next">
      <a href="/index-21.html" rel="next">Older posts &gt;</a>
    </li>
  </ul>
</div>
  </main><footer class="site-footer h-card"><div class="wrapper">
      <div class="footer-col-wrapper">

        <div class="footer-col">
          <p class="site-desc">Personal handnote on software development</p>
        </div>

        <div class="footer-col">
          <div class="p-name">Samson Wang</div>
          <div class="copyright">Copyright 2021, all rights reserved.</div>
          <div class="social-links">
            <ul class="social-media-list">
<li><a rel="me" href="/rss.xml">
                <svg class="svg-icon grey"><use href="/assets/svg/social-icons.svg#rss"></use></svg></a></li>
              <li><a rel="nofollow" href="https://github.com/samsonwang">
                <svg class="svg-icon grey"><use href="/assets/svg/social-icons.svg#github"></use></svg></a></li>
              <li><a rel="nofollow" href="https://twitter.com/samsonwangcn">
                <svg class="svg-icon grey"><use href="/assets/svg/social-icons.svg#twitter"></use></svg></a></li>
              <li><a rel="nofollow" href="https://facebook.com/samsonwangcn">
                 <svg class="svg-icon grey"><use href="/assets/svg/social-icons.svg#facebook"></use></svg></a></li>
            </ul>
</div>

        </div>

      </div>

    </div>

  </footer><div id="scroll-top" title="back to top">
  <div id="scroll-top-arrow"></div>
  <div id="scroll-top-stick"></div>
</div>


      <script src="/assets/js/lazyload.min.js"></script><script src="/assets/js/minima.min.js"></script><!-- google adsense --><script data-ad-client="ca-pub-6303134192857919" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- Google Analytics - Global site tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-108507797-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-108507797-1');
</script><!-- baidu tongji --><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?1dcffb5494ab56e69005c957d7320ad1";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
</body>
</html>
