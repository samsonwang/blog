<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#" lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="x-ua-compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Linux常用命令行指令 - tcpdump | Hack Note</title>
<meta name="theme-color" content="#04519b">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml">
<link href="/assets/css/minima.min.css" rel="stylesheet" type="text/css">
<link rel="canonical" href="https://blog.wangzhl.com/posts/linux-command-examples-tcpdump/">
<link rel="icon" href="/favicon.ico" sizes="64x64">
<link rel="prev" href="/posts/linux-command-examples-nc/" title="Linux常用命令行指令 - nc" type="text/html">
<link rel="next" href="/posts/linux-command-examples-netstat/" title="Linux常用命令行指令 - netstat" type="text/html">
<meta name="author" content="Samson Wang">
<meta property="og:site_name" content="Hack Note">
<meta property="og:title" content="Linux常用命令行指令 - tcpdump">
<meta property="og:url" content="https://blog.wangzhl.com/posts/linux-command-examples-tcpdump/">
<meta property="og:description" content="tcpdump常用于网络抓包，能够将抓取的包保存下来，这样就能进一步深入分析。抓包保存的文件可以使用tcpdump进行查看，也可以借助第三方软件（如wireshark）进行辅助分析。



1. 抓取指定网络设备上的包


抓取网卡eth0上的包

tcpdump -i eth0




2. 限制抓包的数量


只抓取5个包

tcpdump -c 5 -i eth0




3. 将抓取的包以">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-03-25T23:34:53+08:00">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="network">
<meta property="article:tag" content="shell">
<meta property="article:tag" content="tcpdump">
</head>
<body>
  <header class="site-header nav-custom"><div class="wrapper">
      <a class="site-title" rel="author" href="/">Hack Note</a>
      <nav class="site-nav"><input type="checkbox" id="nav-trigger" class="nav-trigger"><label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px"><use href="/assets/svg/theme.svg#menu-icon"></use></svg></span>
        </label>
        <div class="trigger">
          
            <a class="page-link" href="/">Home</a>
            <a class="page-link" href="/archive/">Archive</a>
            <a class="page-link" href="/tags/">Tags</a>
            <a class="page-link" href="/about/">About</a>

        </div>
      </nav>
</div>
  </header><main class="page-content" aria-label="Content"><div class="wrapper">

    

    
<article class="post h-entry" itemscope="" itemtype="http://schema.org/BlogPosting"><header class="post-header"><h1 class="post-title p-name" itemprop="name headline">Linux常用命令行指令 - tcpdump</h1>

    <p class="post-meta">
      
    <time class="dt-published" datetime="2018-03-25T23:34:53+08:00" itemprop="datePublished">Mar 25, 2018</time></p>
  </header><div class="post-content e-content" itemprop="articleBody text">
    <p>
tcpdump常用于网络抓包，能够将抓取的包保存下来，这样就能进一步深入分析。抓包保存的文件可以使用tcpdump进行查看，也可以借助第三方软件（如wireshark）进行辅助分析。<br></p>

<div id="outline-container-org166df40" class="outline-2">
<h2 id="org166df40">1. 抓取指定网络设备上的包</h2>
<div class="outline-text-2" id="text-org166df40">
<p>
抓取网卡eth0上的包<br></p>
<div class="highlight"><pre><span></span>tcpdump -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-orgb7b86d1" class="outline-2">
<h2 id="orgb7b86d1">2. 限制抓包的数量</h2>
<div class="outline-text-2" id="text-orgb7b86d1">
<p>
只抓取5个包<br></p>
<div class="highlight"><pre><span></span>tcpdump -c 5 -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-orgff828c5" class="outline-2">
<h2 id="orgff828c5">3. 将抓取的包以ASCII的方式打印出来</h2>
<div class="outline-text-2" id="text-orgff828c5">
<div class="highlight"><pre><span></span>tcpdump -A -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org735eeec" class="outline-2">
<h2 id="org735eeec">4. 将抓取的包以十六进制的方式打印出来</h2>
<div class="outline-text-2" id="text-org735eeec">
<div class="highlight"><pre><span></span>tcpdump -XX -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org5e7bc80" class="outline-2">
<h2 id="org5e7bc80">5. 对抓取到的包上打出更方便阅读的时间戳</h2>
<div class="outline-text-2" id="text-org5e7bc80">
<p>
增加 <code>-t</code> 参数能够将抓取到的包中的时间以方便阅读的形式打印出来，使用 <code>-tttt</code> 参数能够将包中的时间戳以更详细的方式打印出来。<br></p>
<div class="highlight"><pre><span></span>tcpdump -t -i eth0
tcpdump -tttt -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-orgc93260d" class="outline-2">
<h2 id="orgc93260d">6. 将抓取的包写入到文件中</h2>
<div class="outline-text-2" id="text-orgc93260d">
<div class="highlight"><pre><span></span>tcpdump -w netdump.pcap -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-orgdcb9312" class="outline-2">
<h2 id="orgdcb9312">7. 读取抓到的包</h2>
<div class="outline-text-2" id="text-orgdcb9312">
<div class="highlight"><pre><span></span>tcpdump -r netdump.pcap
</pre></div>
</div>
</div>
<div id="outline-container-orgc0af31a" class="outline-2">
<h2 id="orgc0af31a">8. 在抓到的包中显示ip地址</h2>
<div class="outline-text-2" id="text-orgc0af31a">
<p>
增加 <code>-n</code> 参数不会解析主机名，增加 <code>-nn</code> 参数不会解析主机名和端口名<br></p>
<div class="highlight"><pre><span></span>tcpdump -n -i eth0
tcpdump -nn -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-orgaaf9a0c" class="outline-2">
<h2 id="orgaaf9a0c">9. 以绝对值显示包的ISN号</h2>
<div class="outline-text-2" id="text-orgaaf9a0c">
<div class="highlight"><pre><span></span>tcpdump -S -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org6825b14" class="outline-2">
<h2 id="org6825b14">10. 对抓取到的包显示更详细的信息</h2>
<div class="outline-text-2" id="text-org6825b14">
<p>
参数 <code>-v</code> 是verbose的缩写，以下命令表示对抓取到的包显示更详细的信息。<br></p>
<div class="highlight"><pre><span></span>tcpdump -v -i eth0
tcpdump -vv -i eth0
tcpdump -vvv -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org171cd37" class="outline-2">
<h2 id="org171cd37">11. 对抓到的包进行协议类型过滤</h2>
<div class="outline-text-2" id="text-org171cd37">
<p>
支持的协议类型有：fddi, tr, wlan, ip, ip6, arp, rarp, decnet, tcp, udp<br>
以下命令只会抓取网卡eth0上的arp包<br></p>
<div class="highlight"><pre><span></span>tcpdump -i eth0 arp
</pre></div>
</div>
</div>
<div id="outline-container-org2d74ffd" class="outline-2">
<h2 id="org2d74ffd">12. 在抓包时对包进行大小过滤</h2>
<div class="outline-text-2" id="text-org2d74ffd">
<p>
下面的命令会分别抓取大于1024字节和小于1024字节的包<br></p>
<div class="highlight"><pre><span></span>tcpdump -i eth0 greater 1024
tcpdump -i eth0 less 1024
</pre></div>
</div>
</div>
<div id="outline-container-org01d8638" class="outline-2">
<h2 id="org01d8638">13. 抓取指定端口上的包</h2>
<div class="outline-text-2" id="text-org01d8638">
<div class="highlight"><pre><span></span>tcpdump -i eth0 port 22
</pre></div>
</div>
</div>
<div id="outline-container-orgb2bfbc5" class="outline-2">
<h2 id="orgb2bfbc5">14. 抓取发往指定目的和端口上包</h2>
<div class="outline-text-2" id="text-orgb2bfbc5">
<p>
可以使用 <code>and</code> 和 <code>or</code> 对过滤条件进行组合以实现精确的抓包。<br></p>
<div class="highlight"><pre><span></span>tcpdump -w net_dump.pcap -i eth0 dst 10.181.140.216 and port 22
</pre></div>
</div>
</div>

<div id="outline-container-org6fb2de6" class="outline-2">
<h2 id="org6fb2de6">常用tcpdump命令示例</h2>
<div class="outline-text-2" id="text-org6fb2de6">
<div class="highlight"><pre><span></span>tcpdump –i any 'port 8888'
tcpdump –i any 'tcp port 8888'
tcpdump –i any 'tcp src port 8888'
tcpdump –i any 'tcp src port 8888 and udp dst port 9999'
tcpdump -i any 'src host 127.0.0.1 and tcp src port 12345' -XX -nn -vv
</pre></div>
</div>
</div>

<div id="outline-container-org0de516c" class="outline-2">
<h2 id="org0de516c">参考资料</h2>
<div class="outline-text-2" id="text-org0de516c">
<ul class="org-ul">
<li>
<a href="https://danielmiessler.com/study/tcpdump/">danielmiessler.com tcpdump</a><br>
</li>
<li>
<a href="https://www.thegeekstuff.com/2010/08/tcpdump-command-examples/">thegeekstuff.com tcpdump</a><br>
</li>
</ul>
</div>
</div>
  </div>
  
  <ul class="tags-list vertical-center">
<li>
      <a class="badge" href="/tags/linux/" rel="tag">linux</a>
    </li>
    <li>
      <a class="badge" href="/tags/network/" rel="tag">network</a>
    </li>
    <li>
      <a class="badge" href="/tags/shell/" rel="tag">shell</a>
    </li>
    <li>
      <a class="badge" href="/tags/tcpdump/" rel="tag">tcpdump</a>
    </li>
  </ul></article><ul class="post-pager hidden-print">
<li class="previous">
      <a href="/posts/linux-command-examples-nc/" rel="prev">Previous post
        <br><span>Linux常用命令行指令 - nc</span>
      </a>
    </li>
    <li class="next">
      <a href="/posts/linux-command-examples-netstat/" rel="next">Next post
        <br><span>Linux常用命令行指令 - netstat</span>
      </a>
    </li>
  </ul>
<section class="comments hidden-print"><div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="samsonwang-blog",
            disqus_url="https://blog.wangzhl.com/posts/linux-command-examples-tcpdump/",
        disqus_title="Linux\u5e38\u7528\u547d\u4ee4\u884c\u6307\u4ee4 - tcpdump",
        disqus_identifier="_cache/archives/2018/linux-command-examples-tcpdump.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


  </section><script>var disqus_shortname="samsonwang-blog";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
  </main><footer class="site-footer h-card"><div class="wrapper">
      <div class="footer-col-wrapper">

        <div class="footer-col">
          <p class="site-desc">Personal handnote on software development</p>
        </div>

        <div class="footer-col">
          <div class="p-name">Samson Wang</div>
          <div class="copyright">Copyright 2023, all rights reserved.</div>
          <div class="social-links">
            <ul class="social-media-list">
<li><a rel="me" href="/rss.xml">
                <svg class="svg-icon grey"><use href="/assets/svg/social-icons.svg#rss"></use></svg></a></li>
              <li><a rel="nofollow" href="https://github.com/samsonwang">
                <svg class="svg-icon grey"><use href="/assets/svg/social-icons.svg#github"></use></svg></a></li>
              <li><a rel="nofollow" href="https://twitter.com/samsonwangcn">
                <svg class="svg-icon grey"><use href="/assets/svg/social-icons.svg#twitter"></use></svg></a></li>
              <li><a rel="nofollow" href="https://facebook.com/samsonwangcn">
                 <svg class="svg-icon grey"><use href="/assets/svg/social-icons.svg#facebook"></use></svg></a></li>
            </ul>
</div>

        </div>

      </div>

    </div>

  </footer><div id="scroll-top" title="back to top">
  <div id="scroll-top-arrow"></div>
  <div id="scroll-top-stick"></div>
</div>


      <script src="/assets/js/lazyload.min.js"></script><script src="/assets/js/minima.min.js"></script><!-- google adsense --><script data-ad-client="ca-pub-6303134192857919" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- Google Analytics - Global site tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-108507797-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-108507797-1');
</script>
</body>
</html>
