<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Linux常用命令行指令 - tcpdump | Hack Note</title>
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link href="/assets/css/code.css" rel="stylesheet" type="text/css">
<link href="/assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="/assets/css/highlight.css" rel="stylesheet" type="text/css">
<link href="/assets/css/cerulean.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="/rss.xml">
<link rel="canonical" href="https://samsonwang.me/posts/linux-command-examples-tcpdump/">
<link rel="icon" href="/favicon.ico" sizes="64x64">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><meta name="author" content="Samson Wang">
<link rel="prev" href="/posts/linux-command-examples-nc/" title="Linux常用命令行指令 - nc" type="text/html">
<link rel="next" href="/posts/linux-command-examples-netstat/" title="Linux常用命令行指令 - netstat" type="text/html">
</head>
<body class="preload">
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->
<nav id="top-nav" class="navbar navbar-expand-md fixed-top mb-4 navbar-dark bg-dark"><div class="container">   <!-- This keeps the margins nice -->
    <a class="navbar-brand" href="/">

      <span id="blog-title">Hack Note</span>
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="bs-navbar">
      <ul class="navbar-nav ml-auto">
<li class="nav-item">
<a href="/archive/" class="nav-link">Archives</a>
                </li>
<li class="nav-item">
<a href="/tags/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="/rss.xml" class="nav-link">RSS Feed</a>

        
      </li>
</ul>
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
  </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
  <div class="body-content">
    <!--Body content-->
    <div class="row">

      <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name">Linux常用命令行指令 - tcpdump</h1>

    <div class="metadata">
      

      
  <div class="date blur-1">
    <time class="published dt-published" datetime="2018-03-25T23:34:53+08:00" itemprop="datePublished" title="2018-03-25 23:34">Mar 25 2018</time>
</div>

      

      
    <div class="source blur-1">
      <a href="/posts/linux-command-examples-tcpdump/index.org" class="sourcelink">Source</a>
    </div>

      

      
    <div class="tags blur-2">
    <ul itemprop="keywords">
<li><a class="tag p-category" href="/tags/linux/" rel="tag">linux</a></li>
        <li><a class="tag p-category" href="/tags/network/" rel="tag">network</a></li>
        <li><a class="tag p-category" href="/tags/shell/" rel="tag">shell</a></li>
        <li><a class="tag p-category" href="/tags/tcpdump/" rel="tag">tcpdump</a></li>
    </ul>
</div>

      

    </div>
  </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>
tcpdump常用于网络抓包，能够将抓取的包保存下来，这样就能进一步深入分析。抓包保存的文件可以使用tcpdump进行查看，也可以借助第三方软件（如wireshark）进行辅助分析。<br></p>

<div id="outline-container-orge426426" class="outline-2">
<h2 id="orge426426">1. 抓取指定网络设备上的包</h2>
<div class="outline-text-2" id="text-orge426426">
<p>
抓取网卡eth0上的包<br></p>
<div class="highlight"><pre><span></span>tcpdump -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org8d33418" class="outline-2">
<h2 id="org8d33418">2. 限制抓包的数量</h2>
<div class="outline-text-2" id="text-org8d33418">
<p>
只抓取5个包<br></p>
<div class="highlight"><pre><span></span>tcpdump -c 5 -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-orge7e52c5" class="outline-2">
<h2 id="orge7e52c5">3. 将抓取的包以ASCII的方式打印出来</h2>
<div class="outline-text-2" id="text-orge7e52c5">
<div class="highlight"><pre><span></span>tcpdump -A -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org554a89a" class="outline-2">
<h2 id="org554a89a">4. 将抓取的包以十六进制的方式打印出来</h2>
<div class="outline-text-2" id="text-org554a89a">
<div class="highlight"><pre><span></span>tcpdump -XX -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org20f4de5" class="outline-2">
<h2 id="org20f4de5">5. 对抓取到的包上打出更方便阅读的时间戳</h2>
<div class="outline-text-2" id="text-org20f4de5">
<p>
增加 <code>-t</code> 参数能够将抓取到的包中的时间以方便阅读的形式打印出来，使用 <code>-tttt</code> 参数能够将包中的时间戳以更详细的方式打印出来。<br></p>
<div class="highlight"><pre><span></span>tcpdump -t -i eth0
tcpdump -tttt -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-orgb6c2f0c" class="outline-2">
<h2 id="orgb6c2f0c">6. 将抓取的包写入到文件中</h2>
<div class="outline-text-2" id="text-orgb6c2f0c">
<div class="highlight"><pre><span></span>tcpdump -w netdump.pcap -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org8768249" class="outline-2">
<h2 id="org8768249">7. 读取抓到的包</h2>
<div class="outline-text-2" id="text-org8768249">
<div class="highlight"><pre><span></span>tcpdump -r netdump.pcap
</pre></div>
</div>
</div>
<div id="outline-container-orgd1e4631" class="outline-2">
<h2 id="orgd1e4631">8. 在抓到的包中显示ip地址</h2>
<div class="outline-text-2" id="text-orgd1e4631">
<p>
增加 <code>-n</code> 参数不会解析主机名，增加 <code>-nn</code> 参数不会解析主机名和端口名<br></p>
<div class="highlight"><pre><span></span>tcpdump -n -i eth0
tcpdump -nn -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org446142c" class="outline-2">
<h2 id="org446142c">9. 以绝对值显示包的ISN号</h2>
<div class="outline-text-2" id="text-org446142c">
<div class="highlight"><pre><span></span>tcpdump -S -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-orgd552295" class="outline-2">
<h2 id="orgd552295">10. 对抓取到的包显示更详细的信息</h2>
<div class="outline-text-2" id="text-orgd552295">
<p>
参数 <code>-v</code> 是verbose的缩写，以下命令表示对抓取到的包显示更详细的信息。<br></p>
<div class="highlight"><pre><span></span>tcpdump -v -i eth0
tcpdump -vv -i eth0
tcpdump -vvv -i eth0
</pre></div>
</div>
</div>
<div id="outline-container-org39f57f4" class="outline-2">
<h2 id="org39f57f4">11. 对抓到的包进行协议类型过滤</h2>
<div class="outline-text-2" id="text-org39f57f4">
<p>
支持的协议类型有：fddi, tr, wlan, ip, ip6, arp, rarp, decnet, tcp, udp<br>
以下命令只会抓取网卡eth0上的arp包<br></p>
<div class="highlight"><pre><span></span>tcpdump -i eth0 arp
</pre></div>
</div>
</div>
<div id="outline-container-orgafb1bf2" class="outline-2">
<h2 id="orgafb1bf2">12. 在抓包时对包进行大小过滤</h2>
<div class="outline-text-2" id="text-orgafb1bf2">
<p>
下面的命令会分别抓取大于1024字节和小于1024字节的包<br></p>
<div class="highlight"><pre><span></span>tcpdump -i eth0 greater 1024
tcpdump -i eth0 less 1024
</pre></div>
</div>
</div>
<div id="outline-container-org1cf6fdc" class="outline-2">
<h2 id="org1cf6fdc">13. 抓取指定端口上的包</h2>
<div class="outline-text-2" id="text-org1cf6fdc">
<div class="highlight"><pre><span></span>tcpdump -i eth0 port 22
</pre></div>
</div>
</div>
<div id="outline-container-orgd42c2e4" class="outline-2">
<h2 id="orgd42c2e4">14. 抓取发往指定目的和端口上包</h2>
<div class="outline-text-2" id="text-orgd42c2e4">
<p>
可以使用 <code>and</code> 和 <code>or</code> 对过滤条件进行组合以实现精确的抓包。<br></p>
<div class="highlight"><pre><span></span>tcpdump -w net_dump.pcap -i eth0 dst 10.181.140.216 and port 22
</pre></div>
</div>
</div>

<div id="outline-container-orgff1dcd4" class="outline-2">
<h2 id="orgff1dcd4">常用tcpdump命令示例</h2>
<div class="outline-text-2" id="text-orgff1dcd4">
<div class="highlight"><pre><span></span>tcpdump –i any 'port 8888'
tcpdump –i any 'tcp port 8888'
tcpdump –i any 'tcp src port 8888'
tcpdump –i any 'tcp src port 8888 and udp dst port 9999'
tcpdump -i any 'src host 127.0.0.1 and tcp src port 12345' -XX -nn -vv
</pre></div>
</div>
</div>

<div id="outline-container-orgc7ea3e2" class="outline-2">
<h2 id="orgc7ea3e2">参考资料</h2>
<div class="outline-text-2" id="text-orgc7ea3e2">
<ul class="org-ul">
<li>
<a href="https://danielmiessler.com/study/tcpdump/">danielmiessler.com tcpdump</a><br>
</li>
<li>
<a href="https://www.thegeekstuff.com/2010/08/tcpdump-command-examples/">thegeekstuff.com tcpdump</a><br>
</li>
</ul>
</div>
</div>
  </div>
  

</article>
</div>

      <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 sidebar">
       
<div class="sidebar-module sidebar-module-inset">
  <h4>About Me</h4>
  
        <div class="sidebar-aboutme">
        <p>Zeal for coding, C++ developer. Focused on Linux server develop. I use EMACS on a daily basis.</p>
        </div>
</div>

       
<div class="sidebar-module sidebar-module-inset">
  <h4>Categories</h4>
  
        <ol class="list-unstyled sidebar-category">
<li>
<a href="/tags/category-cpp/">cpp</a>
        </li>
<li>
<a href="/tags/category-emacs/">emacs</a>
        </li>
<li>
<a href="/tags/category-linux/">linux</a>
        </li>
<li>
<a href="/tags/category-windows/">windows</a>
        </li>
</ol>
</div>

      </div>
<!--.sidebar-->
    </div>
<!--.row-->

    

    <ul class="pager hidden-print">
<li class="left">
          <a href="/posts/linux-command-examples-nc/" rel="prev">
            <p class="title">Linux常用命令行指令 - nc</p>
            <p>Previous post</p>
          </a>
      </li>
      <li class="right">
          <a href="/posts/linux-command-examples-netstat/" rel="next">
            <p class="title">Linux常用命令行指令 - netstat</p>
            <p>Next post</p>
          </a>
      </li>
    </ul>
<section class="comments hidden-print"><h2>Comments</h2>
    
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="samsonwang-me",
            disqus_url="https://samsonwang.me/posts/linux-command-examples-tcpdump/",
        disqus_title="Linux\u5e38\u7528\u547d\u4ee4\u884c\u6307\u4ee4 - tcpdump",
        disqus_identifier="cache/archives/2018/linux-command-examples-tcpdump.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


  </section><script>var disqus_shortname="samsonwang-me";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer"><div class="text-center">
<p>Contents © 2017-2019 <a href="mailto:wangzhilv@gmail.com">Samson Wang</a>
 - Powered by <a href="https://getnikola.com/" rel="nofollow">Nikola</a>
 - Hosted on <a href="https://pages.github.com/" rel="nofollow">Github Pages</a>
 - 
<a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/"><img alt="知识共享许可协议" style="padding-bottom:2px" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png"></a>
</p>
</div>

      
    </footer>
</div>
</div>

<div id="scroll-top" title="back to top">
  <div id="scroll-top-arrow"></div>
  <div id="scroll-top-stick"></div>
</div>


            <script src="/assets/js/jquery.min.js"></script><script src="/assets/js/jquery.colorbox-min.js"></script><script src="/assets/js/jquery.lazyload.min.js"></script><script src="/assets/js/popper.min.js"></script><script src="/assets/js/bootstrap.min.js"></script><script src="/assets/js/moment-with-locales.min.js"></script><script src="/assets/js/fancydates.js"></script><script src="/assets/js/cerulean.js"></script><!-- fancy dates --><script>
  moment.locale("en");
  fancydates(0, "YYYY-MM-DD HH:mm");
</script><!-- end fancy dates --><!-- Baidu Analytics --><script>
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7ec47c52179b8ca4f9aee81282bd7b20";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
</body>
</html>
