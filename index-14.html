<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#" lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="x-ua-compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hack Note (old posts, page 14) | Hack Note</title>
<meta name="description" content="Personal handnote on software development">
<meta name="theme-color" content="#04519b">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml">
<link href="/assets/css/minima.min.css" rel="stylesheet" type="text/css">
<link rel="canonical" href="https://blog.wangzhl.com/index-14.html">
<link rel="icon" href="/favicon.ico" sizes="64x64">
<link rel="prev" href="/index-13.html" type="text/html">
<link rel="next" href="/index-15.html" type="text/html">
</head>
<body>
  <header class="site-header nav-custom"><div class="wrapper">
      <a class="site-title" rel="author" href="/">Hack Note</a>
      <nav class="site-nav"><input type="checkbox" id="nav-trigger" class="nav-trigger"><label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px"><use href="/assets/svg/theme.svg#menu-icon"></use></svg></span>
        </label>
        <div class="trigger">
          
            <a class="page-link" href="/">Home</a>
            <a class="page-link" href="/archive/">Archive</a>
            <a class="page-link" href="/tags/">Tags</a>
            <a class="page-link" href="/about/">About</a>

        </div>
      </nav>
</div>
  </header><main class="page-content" aria-label="Content"><div class="wrapper">

    

    


  



  


<div class="home">
  <ul class="post-list">
<li>
    <span class="post-meta">Sep 10, 2018</span>
    <h3>
      <a class="post-link" href="/posts/algorithm/algorithm-weekly-three-sum/">每周算法：三数之和</a>
    </h3>

    <div id="outline-container-org336cc27" class="outline-2">
<h2 id="org336cc27">Description</h2>
<div class="outline-text-2" id="text-org336cc27">
<p>
Given an array nums of n integers, are there elements a, b, c in nums such that a + b + c = 0? Find all unique triplets in the array which gives the sum of zero.<br></p>

<p>
<b>Note:</b><br>
The solution set must not contain duplicate triplets.<br></p>

<p>
<b>Example:</b><br></p>
<pre class="example">
Given array nums = [-1, 0, 1, 2, -1, -4],

A solution set is:
[
  [-1, 0, 1],
  [-1, -1, 2]
]
</pre>

<p>
来源：<a href="https://leetcode.com/problems/3sum/description/">leetcode.com 15 3Sum</a><br></p>
</div>
</div>

<div id="outline-container-org67bd550" class="outline-2">
<h2 id="org67bd550">Solution</h2>
<div class="outline-text-2" id="text-org67bd550">
</div>
<div id="outline-container-org4c2c6ee" class="outline-3">
<h3 id="org4c2c6ee">Approach 1</h3>
<div class="outline-text-3" id="text-org4c2c6ee">
<p>
这道题有点难度，第一时间没有什么思路。我想到的主要问题是如何保证返回结果中不包含重复的一组数。如果使用暴力解法，将所有满足条件的组合取到后进行重复性清洗，应该是一种可行的解法，只是这样做时间复杂度有点高。<br></p>

<p>
下面的代码就是暴力解法的实现。不出意外，在leetcode中结果为超时。这种算法的时间复杂度为 <code>O(n^3 * nlogn) + O(n^2)</code> 。<br></p>
<div class="highlight"><pre><span></span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">threeSum</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span> <span class="n">nums</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">ans</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nums</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">n1</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">nums</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
	    <span class="kt">int</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
	    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">k</span><span class="o">=</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">nums</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">n3</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">+</span> <span class="n">n3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">triplet</span><span class="p">{</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span><span class="p">};</span>
		    <span class="n">sort</span><span class="p">(</span><span class="n">triplet</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">triplet</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
		    <span class="n">ans</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">triplet</span><span class="p">);</span>
		<span class="p">}</span>
	    <span class="p">}</span>
	<span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// 将结果中的重复组合删掉</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;::</span><span class="n">iterator</span> <span class="n">it1</span> <span class="o">=</span> <span class="n">ans</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
	 <span class="n">it1</span> <span class="o">!=</span> <span class="n">ans</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">it1</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;::</span><span class="n">iterator</span> <span class="n">it2</span><span class="o">=</span><span class="n">it1</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">it2</span><span class="o">!=</span><span class="n">ans</span><span class="p">.</span><span class="n">end</span><span class="p">();)</span> <span class="p">{</span>
	    <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">it1</span> <span class="o">==</span> <span class="o">*</span><span class="n">it2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">it2</span> <span class="o">=</span> <span class="n">ans</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">it2</span><span class="p">);</span>
	    <span class="p">}</span>
	    <span class="k">else</span> <span class="p">{</span>
		<span class="o">++</span><span class="n">it2</span><span class="p">;</span>
	    <span class="p">}</span>
	<span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>
从上面这个解法中，我能够得到的 <del>教训</del> 经验是对 <code>vector</code> 进行具有删除操作的循环时，使用迭代器完成更不容易出错。我之前的去重逻辑是这样的。<br></p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">ans</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">ans</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">ans</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">{</span>
	    <span class="n">ans</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">ans</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="o">+</span> <span class="n">j</span><span class="p">);</span>
	<span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>
很显然，上面的代码在一些情况下并不能彻底删去所有重复的元素，下面的代码才是真正正确的实现。<br></p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">ans</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">ans</span><span class="p">.</span><span class="n">size</span><span class="p">();)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">ans</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">{</span>
	    <span class="n">ans</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">ans</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="o">+</span> <span class="n">j</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">else</span> <span class="p">{</span>
	    <span class="o">++</span><span class="n">j</span><span class="p">;</span>
	<span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>

<div id="outline-container-org2381f2c" class="outline-3">
<h3 id="org2381f2c">Approach 2</h3>
<div class="outline-text-3" id="text-org2381f2c">
<p>
我认为这到题的主要难点啊主要是在去除重复的问题上。下面的解法来自 <a href="https://leetcode.com/problems/3sum/discuss/7402/Share-my-AC-C++-solution-around-50ms-O(N*N)-with-explanation-and-comments">leetcode</a> ，在处理重复性问题时，在匹配答案时将重复的数字跳过，这样就不用在后续的结果中进行剔除重复元素的步骤了。<br></p>

<div class="highlight"><pre><span></span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">threeSum</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">num</span><span class="p">)</span> <span class="p">{</span>

    <span class="n">std</span><span class="o">::</span><span class="n">sort</span><span class="p">(</span><span class="n">num</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">num</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>

    <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">res</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

	<span class="kt">int</span> <span class="n">target</span> <span class="o">=</span> <span class="o">-</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">front</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">back</span> <span class="o">=</span> <span class="n">num</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">while</span> <span class="p">(</span><span class="n">front</span> <span class="o">&lt;</span> <span class="n">back</span><span class="p">)</span> <span class="p">{</span>

	    <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">num</span><span class="p">[</span><span class="n">front</span><span class="p">]</span> <span class="o">+</span> <span class="n">num</span><span class="p">[</span><span class="n">back</span><span class="p">];</span>

	    <span class="c1">// Finding answer which start from number num[i]</span>
	    <span class="k">if</span> <span class="p">(</span><span class="n">sum</span> <span class="o">&lt;</span> <span class="n">target</span><span class="p">)</span>
		<span class="n">front</span><span class="o">++</span><span class="p">;</span>

	    <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">sum</span> <span class="o">&gt;</span> <span class="n">target</span><span class="p">)</span>
		<span class="n">back</span><span class="o">--</span><span class="p">;</span>

	    <span class="k">else</span> <span class="p">{</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">triplet</span> <span class="o">=</span> <span class="p">{</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">num</span><span class="p">[</span><span class="n">front</span><span class="p">],</span> <span class="n">num</span><span class="p">[</span><span class="n">back</span><span class="p">]};</span>
		<span class="n">res</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">triplet</span><span class="p">);</span>

		<span class="c1">// Processing duplicates of Number 2</span>
		<span class="c1">// Rolling the front pointer to the next different number forwards</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">front</span> <span class="o">&lt;</span> <span class="n">back</span> <span class="o">&amp;&amp;</span> <span class="n">num</span><span class="p">[</span><span class="n">front</span><span class="p">]</span> <span class="o">==</span> <span class="n">triplet</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		    <span class="o">++</span><span class="n">front</span><span class="p">;</span>
	    <span class="p">}</span>
	<span class="p">}</span>

	<span class="c1">// Processing duplicates of Number 1</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">num</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">num</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
	    <span class="o">++</span><span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>
上面的代码中，只需要跳过 <code>front</code> 所对应的数字就好，因为 <code>back</code> 对应的数字会自然地随 <code>front</code> 变化而变化。<br></p>
</div>
</div>
</div>


<div id="outline-container-org23235c2" class="outline-2">
<h2 id="org23235c2">Reference</h2>
<div class="outline-text-2" id="text-org23235c2">
<ul class="org-ul">
<li>
<a href="https://leetcode.com/problems/3sum/discuss/7402/Share-my-AC-C++-solution-around-50ms-O(N*N)-with-explanation-and-comments">leetcode.com discuss</a><br>
</li>
</ul>
</div>
</div>

  </li>


  <li>
    <span class="post-meta">Sep 07, 2018</span>
    <h3>
      <a class="post-link" href="/posts/algorithm/algorithm-weekly-roman-to-integer/">每周算法：罗马数字转阿拉伯数字</a>
    </h3>

    <div id="outline-container-org1bdbe01" class="outline-2">
<h2 id="org1bdbe01">Description</h2>
<div class="outline-text-2" id="text-org1bdbe01">
<p>
Roman numerals are represented by seven different symbols: I, V, X, L, C, D and M.<br></p>

<pre class="example">
Symbol       Value
I             1
V             5
X             10
L             50
C             100
D             500
M             1000
</pre>

<p>
For example, two is written as <code>II</code> in Roman numeral, just two one's added together. Twelve is written as, <code>XII</code> , which is simply <code>X</code> + <code>II</code> . The number twenty seven is written as <code>XXVII</code> , which is <code>XX</code> + <code>V</code> + <code>II</code> .<br></p>

<p>
Roman numerals are usually written largest to smallest from left to right. However, the numeral for four is not <code>IIII</code> . Instead, the number four is written as <code>IV</code> . Because the one is before the five we subtract it making four. The same principle applies to the number nine, which is written as <code>IX</code> . There are six instances where subtraction is used:<br></p>

<p>
<code>I</code> can be placed before <code>V</code> (5) and <code>X</code> (10) to make 4 and 9.<br><code>X</code> can be placed before <code>L</code> (50) and <code>C</code> (100) to make 40 and 90.<br><code>C</code> can be placed before <code>D</code> (500) and <code>M</code> (1000) to make 400 and 900.<br>
Given a roman numeral, convert it to an integer. Input is guaranteed to be within the range from 1 to 3999.<br></p>

<p>
<b>Example 1:</b><br></p>
<pre class="example">
Input: "III"
Output: 3
</pre>

<p>
<b>Example 2:</b><br></p>
<pre class="example">
Input: "IV"
Output: 4
</pre>

<p>
<b>Example 3:</b><br></p>
<pre class="example">
Input: "IX"
Output: 9
</pre>

<p>
<b>Example 4:</b><br></p>
<pre class="example">
Input: "LVIII"
Output: 58
Explanation: C = 100, L = 50, XXX = 30 and III = 3.
</pre>

<p>
<b>Example 5:</b><br></p>
<pre class="example">
Input: "MCMXCIV"
Output: 1994
Explanation: M = 1000, CM = 900, XC = 90 and IV = 4.
</pre>

<p>
来源：<a href="https://leetcode.com/problems/roman-to-integer/description/">leetcode 13 roman to integer</a><br></p>
</div>
</div>

<div id="outline-container-org7958f4c" class="outline-2">
<h2 id="org7958f4c">Solution</h2>
<div class="outline-text-2" id="text-org7958f4c">
</div>
<div id="outline-container-org0d1d7c1" class="outline-3">
<h3 id="org0d1d7c1">Approach 1</h3>
<div class="outline-text-3" id="text-org0d1d7c1">
<p>
这道题不是很难，很容易就能想到解法，需要注意好边界条件问题，下面就是我的解法。<br></p>
<div class="highlight"><pre><span></span><span class="n">pint</span> <span class="nf">romanToInt</span><span class="p">(</span><span class="n">string</span> <span class="n">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">str</span><span class="p">.</span><span class="n">length</span><span class="p">();</span>

    <span class="c1">// 千位</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'M'</span><span class="p">)</span> <span class="p">{</span>
	<span class="o">++</span><span class="n">pos</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">ans</span> <span class="o">+=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">pos</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">==</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 百位</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span> <span class="p">{</span>
    <span class="k">case</span> <span class="sc">'C'</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="mi">100</span><span class="p">;</span>
	<span class="o">++</span><span class="n">pos</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'D'</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="mi">300</span><span class="p">;</span>
	    <span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'M'</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="mi">800</span><span class="p">;</span>
	    <span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">else</span> <span class="p">{</span>
	    <span class="k">while</span> <span class="p">(</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'C'</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ans</span> <span class="o">+=</span> <span class="mi">100</span><span class="p">;</span>
		<span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	    <span class="p">}</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="sc">'D'</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="mi">500</span><span class="p">;</span>
	<span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'C'</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="mi">100</span><span class="p">;</span>
	    <span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">default</span><span class="o">:</span>
	<span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">==</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 十位</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span> <span class="p">{</span>
    <span class="k">case</span> <span class="sc">'X'</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
	<span class="o">++</span><span class="n">pos</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'C'</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="mi">80</span><span class="p">;</span>
	    <span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'L'</span><span class="p">){</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="mi">30</span><span class="p">;</span>
	    <span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">else</span> <span class="p">{</span>
	    <span class="k">while</span> <span class="p">(</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'X'</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ans</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
		<span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	    <span class="p">}</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="sc">'L'</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="mi">50</span><span class="p">;</span>
	<span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'X'</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
	    <span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">default</span><span class="o">:</span>
	<span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">==</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 个位</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span> <span class="p">{</span>
    <span class="k">case</span> <span class="sc">'I'</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'X'</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="mi">8</span><span class="p">;</span>
	    <span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'V'</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">;</span>
	    <span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">else</span> <span class="p">{</span>
	    <span class="k">while</span> <span class="p">(</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'I'</span><span class="p">)</span> <span class="p">{</span>
		<span class="o">++</span><span class="n">ans</span><span class="p">;</span>
		<span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	    <span class="p">}</span>
	<span class="p">}</span>

	<span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="sc">'V'</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="mi">5</span><span class="p">;</span>
	<span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">str</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'I'</span><span class="p">)</span> <span class="p">{</span>
	    <span class="o">++</span><span class="n">ans</span><span class="p">;</span>
	    <span class="o">++</span><span class="n">pos</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>
    <span class="k">default</span><span class="o">:</span>
	<span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>
不得不说，这样的代码比较丑，这是真的，就算解出来了成就感也不强。<br></p>
</div>
</div>

<div id="outline-container-orga472c61" class="outline-3">
<h3 id="orga472c61">Approach 2</h3>
<div class="outline-text-3" id="text-orga472c61">
<p>
这个解法是leetcode上最快的解法之一，只使用一个循环就完成了计算，代码整体上很简洁，也比较好理解。只需要针对6种特殊情况做特殊处理就好。<br></p>

<div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">romanToInt</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">switch</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
	<span class="k">case</span> <span class="sc">'M'</span><span class="o">:</span>
	    <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'C'</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="mi">800</span><span class="p">;</span>
	    <span class="k">else</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="mi">1000</span><span class="p">;</span>
	    <span class="k">break</span><span class="p">;</span>

	<span class="k">case</span> <span class="sc">'D'</span><span class="o">:</span>
	    <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'C'</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="mi">300</span><span class="p">;</span>
	    <span class="k">else</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="mi">500</span><span class="p">;</span>
	    <span class="k">break</span><span class="p">;</span>

	<span class="k">case</span> <span class="sc">'C'</span><span class="o">:</span>
	    <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'X'</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="mi">80</span><span class="p">;</span>
	    <span class="k">else</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="mi">100</span><span class="p">;</span>
	    <span class="k">break</span><span class="p">;</span>

	<span class="k">case</span> <span class="sc">'L'</span><span class="o">:</span>
	    <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'X'</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="mi">30</span><span class="p">;</span>
	    <span class="k">else</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="mi">50</span><span class="p">;</span>
	    <span class="k">break</span><span class="p">;</span>

	<span class="k">case</span> <span class="sc">'X'</span><span class="o">:</span>
	    <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'I'</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="mi">8</span><span class="p">;</span>
	    <span class="k">else</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
	    <span class="k">break</span><span class="p">;</span>

	<span class="k">case</span> <span class="sc">'V'</span><span class="o">:</span>
	    <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sc">'I'</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">;</span>
	    <span class="k">else</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="mi">5</span><span class="p">;</span>
	    <span class="k">break</span><span class="p">;</span>

	<span class="k">case</span> <span class="sc">'I'</span><span class="o">:</span>
	    <span class="n">result</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
	    <span class="k">break</span><span class="p">;</span>

	<span class="k">default</span><span class="o">:</span><span class="p">;</span>
	<span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>

<div id="outline-container-org114c098" class="outline-3">
<h3 id="org114c098">Approach 3</h3>
<div class="outline-text-3" id="text-org114c098">
<p>
下面这个是我在看该问题的discuss板块的时候发现的。不得不说，结题思路实在新奇，这点是值得学习的。不过我比较担心它的时间复杂度。该方法使用Java编写。<br></p>
<div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">int</span> <span class="nf">romanToInt</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
    <span class="k">if</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="s">"IV"</span><span class="o">)!=-</span><span class="mi">1</span><span class="o">){</span><span class="n">sum</span><span class="o">-=</span><span class="mi">2</span><span class="o">;}</span>
    <span class="k">if</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="s">"IX"</span><span class="o">)!=-</span><span class="mi">1</span><span class="o">){</span><span class="n">sum</span><span class="o">-=</span><span class="mi">2</span><span class="o">;}</span>
    <span class="k">if</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="s">"XL"</span><span class="o">)!=-</span><span class="mi">1</span><span class="o">){</span><span class="n">sum</span><span class="o">-=</span><span class="mi">20</span><span class="o">;}</span>
    <span class="k">if</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="s">"XC"</span><span class="o">)!=-</span><span class="mi">1</span><span class="o">){</span><span class="n">sum</span><span class="o">-=</span><span class="mi">20</span><span class="o">;}</span>
    <span class="k">if</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="s">"CD"</span><span class="o">)!=-</span><span class="mi">1</span><span class="o">){</span><span class="n">sum</span><span class="o">-=</span><span class="mi">200</span><span class="o">;}</span>
    <span class="k">if</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="s">"CM"</span><span class="o">)!=-</span><span class="mi">1</span><span class="o">){</span><span class="n">sum</span><span class="o">-=</span><span class="mi">200</span><span class="o">;}</span>

    <span class="kt">char</span> <span class="n">c</span><span class="o">[]=</span><span class="n">s</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
    <span class="kt">int</span> <span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>

    <span class="k">for</span><span class="o">(;</span><span class="n">count</span><span class="o">&lt;=</span><span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">()-</span><span class="mi">1</span><span class="o">;</span><span class="n">count</span><span class="o">++){</span>
	<span class="k">if</span><span class="o">(</span><span class="n">c</span><span class="o">[</span><span class="n">count</span><span class="o">]==</span><span class="sc">'M'</span><span class="o">)</span> <span class="n">sum</span><span class="o">+=</span><span class="mi">1000</span><span class="o">;</span>
	<span class="k">if</span><span class="o">(</span><span class="n">c</span><span class="o">[</span><span class="n">count</span><span class="o">]==</span><span class="sc">'D'</span><span class="o">)</span> <span class="n">sum</span><span class="o">+=</span><span class="mi">500</span><span class="o">;</span>
	<span class="k">if</span><span class="o">(</span><span class="n">c</span><span class="o">[</span><span class="n">count</span><span class="o">]==</span><span class="sc">'C'</span><span class="o">)</span> <span class="n">sum</span><span class="o">+=</span><span class="mi">100</span><span class="o">;</span>
	<span class="k">if</span><span class="o">(</span><span class="n">c</span><span class="o">[</span><span class="n">count</span><span class="o">]==</span><span class="sc">'L'</span><span class="o">)</span> <span class="n">sum</span><span class="o">+=</span><span class="mi">50</span><span class="o">;</span>
	<span class="k">if</span><span class="o">(</span><span class="n">c</span><span class="o">[</span><span class="n">count</span><span class="o">]==</span><span class="sc">'X'</span><span class="o">)</span> <span class="n">sum</span><span class="o">+=</span><span class="mi">10</span><span class="o">;</span>
	<span class="k">if</span><span class="o">(</span><span class="n">c</span><span class="o">[</span><span class="n">count</span><span class="o">]==</span><span class="sc">'V'</span><span class="o">)</span> <span class="n">sum</span><span class="o">+=</span><span class="mi">5</span><span class="o">;</span>
	<span class="k">if</span><span class="o">(</span><span class="n">c</span><span class="o">[</span><span class="n">count</span><span class="o">]==</span><span class="sc">'I'</span><span class="o">)</span> <span class="n">sum</span><span class="o">+=</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>

  </li>


  <li>
    <span class="post-meta">Sep 05, 2018</span>
    <h3>
      <a class="post-link" href="/posts/algorithm/algorithm-weekly-integer-to-roman/">每周算法：阿拉伯数字转换罗马数字</a>
    </h3>

    <div id="outline-container-org79fa5d6" class="outline-2">
<h2 id="org79fa5d6">Description</h2>
<div class="outline-text-2" id="text-org79fa5d6">
<p>
Roman numerals are represented by seven different symbols: <code>I</code> , <code>V</code> , <code>X</code> , <code>L</code> , <code>C</code> , <code>D</code> and <code>M</code>.<br></p>
<pre class="example">
Symbol       Value
I             1
V             5
X             10
L             50
C             100
D             500
M             1000
</pre>

<p>
For example, two is written as <code>II</code> in Roman numeral, just two one's added together. Twelve is written as, <code>XII</code> , which is simply <code>X</code> + <code>II</code> . The number twenty seven is written as <code>XXVII</code> , which is <code>XX</code> + <code>V</code> + <code>II</code> .<br></p>

<p>
Roman numerals are usually written largest to smallest from left to right. However, the numeral for four is not <code>IIII</code> . Instead, the number four is written as <code>IV</code> . Because the one is before the five we subtract it making four. The same principle applies to the number nine, which is written as <code>IX</code>. There are six instances where subtraction is used:<br></p>

<ul class="org-ul">
<li>
<code>I</code> can be placed before <code>V</code> (5) and <code>X</code> (10) to make 4 and 9.<br>
</li>
<li>
<code>X</code> can be placed before <code>L</code> (50) and <code>C</code> (100) to make 40 and 90.<br>
</li>
<li>
<code>C</code> can be placed before <code>D</code> (500) and <code>M</code> (1000) to make 400 and 900.<br>
</li>
</ul>
<p>
Given an integer, convert it to a roman numeral. Input is guaranteed to be within the range from 1 to 3999.<br></p>

<p>
<b>Example 1:</b><br></p>
<pre class="example">
Input: 3
Output: "III"
</pre>

<p>
<b>Example 2:</b><br></p>
<pre class="example">
Input: 4
Output: "IV"
</pre>

<p>
<b>Example 3:</b><br></p>
<pre class="example">
Input: 9
Output: "IX"
</pre>

<p>
<b>Example 4:</b><br></p>
<pre class="example">
Input: 58
Output: "LVIII"
Explanation: C = 100, L = 50, XXX = 30 and III = 3.
</pre>

<p>
<b>Example 5:</b><br></p>
<pre class="example">
Input: 1994
Output: "MCMXCIV"
Explanation: M = 1000, CM = 900, XC = 90 and IV = 4.
</pre>

<p>
来源：<a href="https://leetcode.com/problems/integer-to-roman/description/">leetcode 12 integer to roman</a><br></p>
</div>
</div>

<div id="outline-container-orga31dd79" class="outline-2">
<h2 id="orga31dd79">Solution</h2>
<div class="outline-text-2" id="text-orga31dd79">
</div>
<div id="outline-container-orgb25db90" class="outline-3">
<h3 id="orgb25db90">Approach 1</h3>
<div class="outline-text-3" id="text-orgb25db90">
<p>
这道题并不难，方法也很容易想到，这道题被归为 <code>medium</code> 难度反而让我感到有些奇怪，下面的代码就是我的解法。<br></p>
<div class="highlight"><pre><span></span><span class="n">string</span> <span class="nf">intToRoman</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// digit1 ~ 4 分别代表个十百千</span>
    <span class="kt">int</span> <span class="n">digit1</span> <span class="o">=</span> <span class="n">num</span><span class="o">%</span><span class="mi">10</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">digit2</span> <span class="o">=</span> <span class="n">num</span><span class="o">/</span><span class="mi">10</span><span class="o">%</span><span class="mi">10</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">digit3</span> <span class="o">=</span> <span class="n">num</span><span class="o">/</span><span class="mi">100</span><span class="o">%</span><span class="mi">10</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">digit4</span> <span class="o">=</span> <span class="n">num</span><span class="o">/</span><span class="mi">1000</span><span class="o">%</span><span class="mi">10</span><span class="p">;</span>

    <span class="n">string</span> <span class="n">ans</span><span class="p">;</span>

    <span class="c1">// 千</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">digit4</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="sc">'M'</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 百</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">digit3</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">digit3</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="sc">'C'</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="s">"CD"</span><span class="p">;</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">6</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">7</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">8</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="sc">'D'</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">digit3</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="sc">'C'</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="mi">9</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="s">"CM"</span><span class="p">;</span>
	<span class="k">break</span><span class="p">;</span>
    <span class="k">default</span><span class="o">:</span>
	<span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 十</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">digit2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">digit2</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="sc">'X'</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="s">"XL"</span><span class="p">;</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">6</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">7</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">8</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="sc">'L'</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">digit2</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="s">"X"</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="mi">9</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="s">"XC"</span><span class="p">;</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">default</span><span class="o">:</span>
	<span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// 个</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">digit1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">digit1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="sc">'I'</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="s">"IV"</span><span class="p">;</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">6</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">7</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">8</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="sc">'V'</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">digit1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">ans</span> <span class="o">+=</span> <span class="sc">'I'</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="mi">9</span><span class="o">:</span>
	<span class="n">ans</span> <span class="o">+=</span> <span class="s">"IX"</span><span class="p">;</span>
	<span class="k">break</span><span class="p">;</span>

    <span class="k">default</span><span class="o">:</span>
	<span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>
这样做感觉有点简单粗暴，而且代码看起来不够优雅。<br></p>
</div>
</div>

<div id="outline-container-org479b226" class="outline-3">
<h3 id="org479b226">Approach 2</h3>
<div class="outline-text-3" id="text-org479b226">
<p>
下面代码是从leetcode上找的，这样的打表法，看起来至少从形式上会更加美观，而且也非常好理解。<br></p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">const</span> <span class="k">static</span> <span class="n">string</span> <span class="n">THOUS</span><span class="p">[];</span>
    <span class="k">const</span> <span class="k">static</span> <span class="n">string</span> <span class="n">HUNDS</span><span class="p">[];</span>
    <span class="k">const</span> <span class="k">static</span> <span class="n">string</span> <span class="n">TENS</span><span class="p">[];</span>
    <span class="k">const</span> <span class="k">static</span> <span class="n">string</span> <span class="n">ONES</span><span class="p">[];</span>
    <span class="n">string</span> <span class="nf">intToRoman</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">string</span> <span class="n">result</span><span class="p">;</span>
	<span class="n">result</span> <span class="o">+=</span> <span class="n">THOUS</span><span class="p">[(</span><span class="kt">int</span><span class="p">)(</span><span class="n">num</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">%</span><span class="mi">10</span><span class="p">];</span>
	<span class="n">result</span> <span class="o">+=</span> <span class="n">HUNDS</span><span class="p">[(</span><span class="kt">int</span><span class="p">)(</span><span class="n">num</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">%</span><span class="mi">10</span><span class="p">];</span>
	<span class="n">result</span> <span class="o">+=</span> <span class="n">TENS</span><span class="p">[(</span><span class="kt">int</span><span class="p">)(</span><span class="n">num</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">%</span><span class="mi">10</span><span class="p">];</span>
	<span class="n">result</span> <span class="o">+=</span> <span class="n">ONES</span><span class="p">[</span><span class="n">num</span><span class="o">%</span><span class="mi">10</span><span class="p">];</span>
	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="k">const</span> <span class="n">string</span> <span class="n">Solution</span><span class="o">::</span><span class="n">THOUS</span><span class="p">[]</span>	<span class="o">=</span> <span class="p">{</span><span class="s">""</span><span class="p">,</span><span class="s">"M"</span><span class="p">,</span><span class="s">"MM"</span><span class="p">,</span><span class="s">"MMM"</span><span class="p">};</span>
<span class="k">const</span> <span class="n">string</span> <span class="n">Solution</span><span class="o">::</span><span class="n">HUNDS</span><span class="p">[]</span>	<span class="o">=</span> <span class="p">{</span><span class="s">""</span><span class="p">,</span><span class="s">"C"</span><span class="p">,</span><span class="s">"CC"</span><span class="p">,</span><span class="s">"CCC"</span><span class="p">,</span><span class="s">"CD"</span><span class="p">,</span><span class="s">"D"</span><span class="p">,</span><span class="s">"DC"</span><span class="p">,</span><span class="s">"DCC"</span><span class="p">,</span><span class="s">"DCCC"</span><span class="p">,</span><span class="s">"CM"</span><span class="p">};</span>
<span class="k">const</span> <span class="n">string</span> <span class="n">Solution</span><span class="o">::</span><span class="n">TENS</span><span class="p">[]</span>	<span class="o">=</span> <span class="p">{</span><span class="s">""</span><span class="p">,</span><span class="s">"X"</span><span class="p">,</span><span class="s">"XX"</span><span class="p">,</span><span class="s">"XXX"</span><span class="p">,</span><span class="s">"XL"</span><span class="p">,</span><span class="s">"L"</span><span class="p">,</span><span class="s">"LX"</span><span class="p">,</span><span class="s">"LXX"</span><span class="p">,</span><span class="s">"LXXX"</span><span class="p">,</span><span class="s">"XC"</span><span class="p">};</span>
<span class="k">const</span> <span class="n">string</span> <span class="n">Solution</span><span class="o">::</span><span class="n">ONES</span><span class="p">[]</span>	<span class="o">=</span> <span class="p">{</span><span class="s">""</span><span class="p">,</span><span class="s">"I"</span><span class="p">,</span><span class="s">"II"</span><span class="p">,</span><span class="s">"III"</span><span class="p">,</span><span class="s">"IV"</span><span class="p">,</span><span class="s">"V"</span><span class="p">,</span><span class="s">"VI"</span><span class="p">,</span><span class="s">"VII"</span><span class="p">,</span><span class="s">"VIII"</span><span class="p">,</span><span class="s">"IX"</span><span class="p">};</span>
</pre></div>
</div>
</div>

<div id="outline-container-org3f96420" class="outline-3">
<h3 id="org3f96420">Approach 3</h3>
<div class="outline-text-3" id="text-org3f96420">
<p>
下面这段代码也是leetcode上的答案，这个答案的通用性要好一些，最起码找到了规律，这有助于算法的后续拓展。<br></p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">string</span> <span class="n">intToRoman</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">base</span><span class="p">{</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">};</span>
	<span class="n">string</span> <span class="n">roman</span> <span class="o">=</span> <span class="s">"MDCLXVI"</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span>
	<span class="n">string</span> <span class="n">ret</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="p">{</span>
	    <span class="n">r</span> <span class="o">=</span> <span class="n">num</span><span class="o">/</span><span class="n">base</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
	    <span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">-</span> <span class="n">r</span><span class="o">*</span><span class="n">base</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
	    <span class="k">if</span><span class="p">(</span><span class="n">r</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ret</span> <span class="o">+=</span> <span class="n">roman</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">index</span><span class="p">];</span>
		<span class="n">ret</span> <span class="o">+=</span> <span class="n">roman</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
	    <span class="p">}</span>
	    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">r</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ret</span> <span class="o">+=</span> <span class="n">roman</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">index</span><span class="p">];</span>
		<span class="n">ret</span> <span class="o">+=</span> <span class="n">roman</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">index</span> <span class="o">-</span><span class="mi">2</span><span class="p">];</span>
	    <span class="p">}</span>
	    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">r</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ret</span> <span class="o">+=</span> <span class="n">roman</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
		<span class="c1">// 下面这个string的用法值得学习</span>
		<span class="n">string</span> <span class="nf">tmp</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">roman</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">index</span><span class="p">]);</span>
		<span class="n">ret</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">;</span>
	    <span class="p">}</span>
	    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">string</span> <span class="n">tmp</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">roman</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">index</span><span class="p">]);</span>
		<span class="n">ret</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">;</span>
	    <span class="p">}</span>
	    <span class="n">index</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>
<p>
此外，我还学到了 <code>string tmp(num, ch)</code> 这样的创建具有重复字符的字符串的方法。<br></p>
</div>
</div>
</div>

  </li>


  <li>
    <span class="post-meta">Sep 04, 2018</span>
    <h3>
      <a class="post-link" href="/posts/2018/static-member-initialization-and-private-member-function/">静态成员变量初始化相关问题</a>
    </h3>

    <div id="outline-container-org7b2225c" class="outline-2">
<h2 id="org7b2225c">引言</h2>
<div class="outline-text-2" id="text-org7b2225c">
<p>
这篇文章的起因是出于对于 <code>C++</code> 饿汉单例模式代码的一些疑问，查阅了一些资料。在仔细研究后，我发现在一些基础概念的理解还是存在偏差。<br>
下面请看这样的一段代码，能看出其中有那些不太“正常”的语句么。<br></p>

<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Singleton</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="k">static</span> <span class="n">Singleton</span><span class="o">*</span> <span class="n">getInstance</span><span class="p">();</span>
<span class="k">private</span><span class="o">:</span>
    <span class="n">Singleton</span><span class="p">()</span> <span class="p">{}</span>
    <span class="k">static</span> <span class="n">Singleton</span><span class="o">*</span> <span class="n">instance</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">Singleton</span><span class="o">*</span> <span class="n">Singleton</span><span class="o">::</span><span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Singleton</span><span class="p">();</span>
<span class="n">Singleton</span><span class="o">*</span> <span class="n">Singleton</span><span class="o">::</span><span class="n">getInstance</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">instance</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>

<div id="outline-container-org8741ada" class="outline-2">
<h2 id="org8741ada">私有静态成员的初始化</h2>
<div class="outline-text-2" id="text-org8741ada">
<p>
上面的代码是饿汉单例模式的 <code>C++</code> 的实现，在没有查阅资料之前，我对其中私有静态成员变量的初始化存疑。主要有以下两点：<br></p>
<ul class="org-ul">
<li>为什么私有变量能够在类外被修改<br>
</li>
<li>为什么私有构造函数能够在类外被调用<br>
</li>
</ul>
<p>
在我之前的知识积累中， <b>私有的成员变量或成员函数是不能够在类外被访问的</b> 。那么为什么以上代码没有问题呢？<br></p>

<p>
在C++标准中找到了下面的一段话(可以在 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3690.pdf">C++11 standard</a> 的 9.4.2节 或  <a href="http://eel.is/c++draft/class.static.data#2">C++ standard working draft</a> 的 10.3.9.2节 中找到)<br></p>
<blockquote>
<p>
The initializer expression in the definition of a static data member is in the scope of its class.<br></p>
</blockquote>
<p>
这句话的意思是：静态成员变量的初始化是被看做为它自身的类域中的（ <del>翻译的可能不是很准</del> ）。这样就不难理解为什么私有的静态成员变量能够在其类外被初始化了，由其私有构造函数进行构造也能说的通了。<br></p>


<p>
<b>同样</b> ,在C++标准中给出了下面这样的示例代码：<br></p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">process</span> <span class="p">{</span>
  <span class="k">static</span> <span class="n">process</span><span class="o">*</span> <span class="n">run_chain</span><span class="p">;</span>
  <span class="k">static</span> <span class="n">process</span><span class="o">*</span> <span class="n">running</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">process</span><span class="o">*</span> <span class="n">process</span><span class="o">::</span><span class="n">running</span> <span class="o">=</span> <span class="n">get_main</span><span class="p">();</span>
<span class="n">process</span><span class="o">*</span> <span class="n">process</span><span class="o">::</span><span class="n">run_chain</span> <span class="o">=</span> <span class="n">running</span><span class="p">;</span>
</pre></div>

<p>
给出的说明如下：<br></p>
<blockquote>
<p>
The static data member <code>run_chain</code> of class process is defined in global scope; the notation <code>process​::​run_chain</code> specifies that the member <code>run_chain</code> is a member of class <code>process</code> and in the scope of class <code>process</code>. In the static data member definition, the initializer expression refers to the static data member running of class <code>process</code>.<br></p>
</blockquote>
<p>
静态成员 <code>run_chain</code> 定义在全局域；而 <code>process::run_chain</code> 则表示 <code>run_chain</code> 是 <code>process</code> 类的成员变量，从而处在 <code>process</code> 类的作用域中。<br></p>
</div>
</div>

<div id="outline-container-orgacc5bbe" class="outline-2">
<h2 id="orgacc5bbe">私有构造函数</h2>
<div class="outline-text-2" id="text-orgacc5bbe">
<p>
在查阅资料时，我发现 Peter 的 <a href="https://stackoverflow.com/a/41361967">描述</a> 纠正了我对私有构造函数的一些看法。<br></p>
<blockquote>
<p>
The point of a <code>private</code> constructor is not preventing object construction. It is about controlling which code can access the constructor, and therefore limiting which code to create an object that is an instance of that class. A <code>private</code> constructor is accessible to all member functions ( <code>static</code> or otherwise) of the class, and to all declared <code>friend</code> s of the class (which may be individual functions, or other classes) - so any of those can create an instance of the class using a <code>private</code> constructor (assuming the constructor is defined).<br></p>
</blockquote>
<p>
私有构造函数的目的并不是禁止对象构造，其目的在于控制哪些代码能够调用这个构造函数，进而限制类对象的创建。私有的构造函数可以被该类的所有成员函数（静态或非静态的）调用，该类的友元类或友元方法也能访问该类的私有函数，所以在上述情况中都可以通过私有的构造函数实例化出类对象。<br></p>
</div>
</div>

<div id="outline-container-orgfe027bc" class="outline-2">
<h2 id="orgfe027bc">参考资料</h2>
<div class="outline-text-2" id="text-orgfe027bc">
<ul class="org-ul">
<li>
<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3690.pdf">ISO C++11 standard</a><br>
</li>
<li>
<a href="http://eel.is/c++draft/class.static.data#2">ISO C++ standard working draft</a><br>
</li>
<li>
<a href="https://stackoverflow.com/questions/38583989/access-to-private-static-function-during-static-member-initialization">stackoverflow.com - access to private static function…</a><br>
</li>
<li>
<a href="https://stackoverflow.com/questions/41361223/why-private-constructor-prevents-object-creation-c">stackoverflow.com - private constructor</a><br>
</li>
<li>
<a href="https://stackoverflow.com/questions/7857989/static-member-variable-when-declared-private">stackoverflow.com - static member variable when declared private</a><br>
</li>
<li>
<a href="https://en.cppreference.com/w/cpp/language/static#Static_data_members">cppreference.com - static data members</a><br>
</li>
</ul>
</div>
</div>

  </li>


  <li>
    <span class="post-meta">Aug 31, 2018</span>
    <h3>
      <a class="post-link" href="/posts/2018/non-blocking-socket-connect-tips/">客户端使用非阻塞socket进行connect的流程</a>
    </h3>

    <div id="outline-container-org284592b" class="outline-2">
<h2 id="org284592b">问题</h2>
<div class="outline-text-2" id="text-org284592b">
<p>
使用非阻塞（ <code>non-blocking</code> ） socket尝试与服务端建立连接（ <code>connect</code> ）时，由于是io非阻塞的，所以 <code>connect</code> 函数会立即返回，那么如何判断client与server连接成功了呢？<br></p>
</div>
</div>

<div id="outline-container-org65eb7cd" class="outline-2">
<h2 id="org65eb7cd">解答</h2>
<div class="outline-text-2" id="text-org65eb7cd">
<p>
客户端建立连接的示例代码如下：<br></p>
<div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="p">...);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">res</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">errno</span> <span class="o">!=</span> <span class="n">EINPROGRESS</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// case1. error, fail somehow, close socket</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="n">res</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// case2. connection has succeeded immediately</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// case3. connection attempt is in progress</span>
<span class="p">}</span>
</pre></div>
<p>
由于是非阻塞模式，所以 <code>connect</code> 之后会直接返回，根据返回值 <code>res</code> 和 <code>errno</code> 能够判断建立连接的结果。<br></p>
<ul class="org-ul">
<li>case1，表示连接失败；<br>
</li>
<li>case2，表示连接建立成功；<br>
</li>
<li>case3，表示正在建立连接的过程中，在这个情况下，需要等待socket变成可写（writable）状态，可以使用 <code>select</code> 或 <code>epoll</code> 完成；<br>
</li>
</ul>
<p>
在 case3 情况下，socket可写后，执行下面的代码检查socket是否出现错误。<br></p>
<ul class="org-ul">
<li>case4和case5，表示socket出现了错误，将会关闭连接；<br>
</li>
<li>case6，表示连接建立成功，可以开始 <code>read</code> 和 <code>write</code> 了。<br>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">result</span><span class="p">;</span>
<span class="kt">socklen_t</span> <span class="n">result_len</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">getsockopt</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">SO_ERROR</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">result</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">result_len</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// case4. error, fail somehow, close socket</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// case5. connection failed; error code is in 'result'</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// case6. socket is ready for read()/write()</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgb6fa07b" class="outline-2">
<h2 id="orgb6fa07b">参考资料</h2>
<div class="outline-text-2" id="text-orgb6fa07b">
<ul class="org-ul">
<li>
<a href="https://stackoverflow.com/questions/10187347/async-connect-and-disconnect-with-epoll-linux/10194883#10194883">stackoverflow.com</a><br>
</li>
</ul>
</div>
</div>

  </li>


  <li>
    <span class="post-meta">Aug 29, 2018</span>
    <h3>
      <a class="post-link" href="/posts/algorithm/algorithm-weekly-container-with-most-water/">每周算法：最大容器</a>
    </h3>

    <div id="outline-container-org7a36f34" class="outline-2">
<h2 id="org7a36f34">Description</h2>
<div class="outline-text-2" id="text-org7a36f34">
<p>
Given n non-negative integers a1, a2, …, an , where each represents a point at coordinate (i, ai). n vertical lines are drawn such that the two endpoints of line i is at (i, ai) and (i, 0). Find two lines, which together with x-axis forms a container, such that the container contains the most water.<br></p>

<p>
<b>Note:</b> You may not slant the container and n is at least 2.<br></p>

<p>
<b>Example:</b><br>
Input: [1,8,6,2,5,4,8,3,7]<br>
Output: 49<br></p>

<p>
来源： <a href="https://leetcode.com/problems/container-with-most-water/description/">leetcode 11 Container with most water</a><br></p>
</div>
</div>

<div id="outline-container-org7a8a037" class="outline-2">
<h2 id="org7a8a037">Solution</h2>
<div class="outline-text-2" id="text-org7a8a037">
</div>
<div id="outline-container-org181c35a" class="outline-3">
<h3 id="org181c35a">Approach 1 暴力解法</h3>
<div class="outline-text-3" id="text-org181c35a">
<p>
暴力解法是最容易想到的解法了，然而暴力解法肯定不是本题的意图。<br></p>

<div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">maxArea</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span> <span class="n">height</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">height</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
	    <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">min</span><span class="p">(</span><span class="n">height</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">height</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
	    <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span> <span class="o">&gt;</span> <span class="n">size</span> <span class="o">?</span> <span class="nl">ans</span> <span class="p">:</span> <span class="n">size</span><span class="p">;</span>
	<span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>
使用这种解法只要把变量变化的范围想清楚就行了，没有什么特别的难点。<br>
暴力解法的时间复杂度为 O(n<sup>2</sup>)，空间复杂度为 O(1)。<br></p>
</div>
</div>

<div id="outline-container-orgb926e72" class="outline-3">
<h3 id="orgb926e72">Approach 2</h3>
<div class="outline-text-3" id="text-orgb926e72">
<p>
我在leetcode上看到这样一种解法，这种解法从逻辑和形式上看上不复杂，但是我的疑问在是否有严密的数学推导和论证。<br></p>

<div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">maxArea</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&amp;</span> <span class="n">height</span><span class="p">)</span> <span class="p">{</span>

    <span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">right</span> <span class="o">=</span> <span class="n">height</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span><span class="p">)</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="n">right</span> <span class="o">-</span> <span class="n">left</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">h</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">height</span><span class="p">[</span><span class="n">left</span><span class="p">],</span> <span class="n">height</span><span class="p">[</span><span class="n">right</span><span class="p">]);</span>

	<span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">ans</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">height</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">height</span><span class="p">[</span><span class="n">right</span><span class="p">])</span> <span class="p">{</span>
	    <span class="o">++</span><span class="n">left</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">else</span> <span class="p">{</span>
	    <span class="o">--</span><span class="n">right</span><span class="p">;</span>
	<span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>
这个算法的主要思想是最大面积由两端边界较短的板决定；所以在移动边界时要将长板保留，移动短板。该算法的时间复杂度为 O(n)，空间复杂度为O（1）。<br></p>

<p>
在寻求该算法的数学推导时，我看到了 @nan15 给出的另外一种解释：<br></p>
<blockquote>
<p>
We starts with the widest container, <code>l = 0</code> and <code>r = n - 1</code> . Let's say the left one is shorter: <code>h[l] &lt; h[r]</code> . Then, this is already the largest container the left one can possibly form. There's no need to consider it again. Therefore, we just throw it away and start again with <code>l = 1</code> and <code>r = n - 1</code> .<br></p>
</blockquote>
<p>
这个论证我认为是更加直观的：从最宽的容器开始，这时左边坐标 <code>l = 0</code> ，右边坐标 <code>r = n - 1</code> 。假设左边更短，也就是 <code>h[l] &lt; h[r]</code> 。那么，对于左边的板子，这是已经是它能够形成的最大的面积了，也就不需要再考虑它了。因此，将左边的板子丢掉，使用 <code>l = 1</code> 和 <code>r = n - 1</code> 重新开始。<br></p>
</div>
</div>
</div>

<div id="outline-container-org35c48d3" class="outline-2">
<h2 id="org35c48d3">Reference</h2>
<div class="outline-text-2" id="text-org35c48d3">
<ul class="org-ul">
<li>
<a href="https://leetcode.com/problems/container-with-most-water/solution/">leetcode problem solution</a><br>
</li>
<li>
<a href="https://leetcode.com/problems/container-with-most-water/discuss/6089/anyone-who-has-a-on-algorithm">leetcode discuss algorithm proof 1</a><br>
</li>
<li>
<a href="https://leetcode.com/problems/container-with-most-water/discuss/6099/yet-another-way-to-see-what-happens-in-the-on-algorithm">leetcode discuss algorithm proof 2</a><br>
</li>
</ul>
</div>
</div>

  </li>

</ul>
</div>




    

  <ul class="index-pager hidden-print">
<li class="previous">
      <a href="/index-13.html" rel="prev">&lt; Newer posts</a>
    </li>
    <li class="next">
      <a href="/index-15.html" rel="next">Older posts &gt;</a>
    </li>
  </ul>
</div>
  </main><footer class="site-footer h-card"><div class="wrapper">
      <div class="footer-col-wrapper">

        <div class="footer-col">
          <p class="site-desc">Personal handnote on software development</p>
        </div>

        <div class="footer-col">
          <div class="p-name">Samson Wang</div>
          <div class="u-email"><a href="mailto:wangzhilv@gmail.com">wangzhilv@gmail.com</a></div>
          <div class="copyright">Copyright 2021, all rights reserved.</div>
          <div class="social-links">
            <ul class="social-media-list">
<li><a rel="me" href="/rss.xml">
                <svg class="svg-icon grey"><use href="/assets/svg/social-icons.svg#rss"></use></svg></a></li>
              <li><a rel="nofollow" href="https://github.com/samsonwang">
                <svg class="svg-icon grey"><use href="/assets/svg/social-icons.svg#github"></use></svg></a></li>
              <li><a rel="nofollow" href="https://twitter.com/samsonwangcn">
                <svg class="svg-icon grey"><use href="/assets/svg/social-icons.svg#twitter"></use></svg></a></li>
              <li><a rel="nofollow" href="https://facebook.com/samsonwangcn">
                 <svg class="svg-icon grey"><use href="/assets/svg/social-icons.svg#facebook"></use></svg></a></li>
            </ul>
</div>

        </div>

      </div>

    </div>

  </footer><div id="scroll-top" title="back to top">
  <div id="scroll-top-arrow"></div>
  <div id="scroll-top-stick"></div>
</div>


      <script src="/assets/js/lazyload.min.js"></script><script src="/assets/js/minima.min.js"></script><!-- google adsense --><script data-ad-client="ca-pub-6303134192857919" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><!-- Google Analytics - Global site tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-108507797-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-108507797-1');
</script><!-- baidu tongji --><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?1dcffb5494ab56e69005c957d7320ad1";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
</body>
</html>
